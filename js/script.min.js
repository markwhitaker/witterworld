"use strict";$((function(){const t=["#00C4F0","#00BCE5","#00B3DB","#00ABD1","#00A3C7"],o="https://flagcdn.com/{0}.svg",e="https://www.youtube.com/watch?v={0}";let i,n={},r=[],l=[];var a;function c(){i=new jvm.Map({map:"world_merc",container:$("#map"),backgroundColor:"#f0f0f0",zoomMin:.9,focusOn:{x:.5,y:.5,scale:.95},series:{regions:[{attribute:"fill"}]},onRegionClick:function(t,o){p(o)},onRegionTipShow:function(t,o,e){let i=n[e];i&&o.text("{0}: {1} ({2})".format(i.country,i.title,i.year))}}),i.series.regions[0].setValues(function(){let t={};for(let o in i.regions)t[o]=n[o]?n[o].colour:"#555555";return t}())}function s(){i&&(i.remove(),i=void 0)}function u(t,e,i,n){$(t).empty(),e.forEach((function(e){$("<span></span>").addClass("listFilm").prop({title:n(e),style:"background-color: {0}".format(e.colour)}).text(i(e)).click((function(){p(e.countryCode)})).prepend($("<img/>").prop({src:o.format(e.countryCode.toLowerCase()),alt:"National flag of {0}".format(e.country)})).appendTo(t)}))}function f(t){$(t).addClass("selected").siblings().removeClass("selected")}function m(t){$(t).show().siblings().hide()}function p(t){let i=n[t];i&&($("#filmCountry").text(i.country),$("#filmTitle").text(i.title),$("#filmYear").text(i.year),$("#filmCountryFlag").prop({src:o.format(i.countryCode.toLowerCase()),alt:"National flag of {0}".format(i.country)}),$("#filmImageContainer").toggleClass("defaultImage",!i.image),$("#filmImage").prop({src:i.image,alt:"Film poster for {0}".format(i.title)}).toggle(!!i.image),$("#filmOriginalTitle").text(i.originalTitle).toggle(!!i.originalTitle),g("#imdbLink","https://www.imdb.com/title/{0}/",i.imdb),g("#letterboxdLink","https://letterboxd.com/film/{0}/",i.letterboxd),g("#rottenTomatoesLink","https://www.rottentomatoes.com/m/{0}",i.rottenTomatoes),g("#wikipediaLink","https://en.wikipedia.org/wiki/{0}",i.wikipedia),g("#justwatchLink","https://www.justwatch.com/uk/movie/{0}",i.justwatch),g("#trailerLink",e,i.trailer),g("#reviewLink",e,i.review),$("#filmReviewer").text(i.reviewer),$("#filmDetailsModal").modal())}function g(t,o,e){$(t).prop({href:o.format(e)}).toggle(!!e)}$("a").prop("target","_blank"),$("#btnShowMap").click((function(){f("#btnShowMap"),m("#sectionMap"),c()})),$("#btnShowListCountries").click((function(){f("#btnShowListCountries"),m("#sectionListCountries"),s()})),$("#btnShowListFilms").click((function(){f("#btnShowListFilms"),m("#sectionListFilms"),s()})),$("#btnShowAbout").click((function(){f("#btnShowAbout"),m("#sectionAbout"),s()})),$("#filmCountryFlag").on({error:function(){$(this).hide()},load:function(){$(this).show()}}),a=function(){$("#filmCount").text(r.length),c(),u("#listCountries",r,(function(t){return t.country}),(function(t){return"{0} ({1})".format(t.title,t.year)})),u("#listFilms",l,(function(t){return"{0} ({1})".format(t.title,t.year)}),(function(t){return t.country}))},r=[],n={},$.getJSON("data/films.json",(function(o){o.forEach((function(o){o.colour=function(){let o=Math.floor(Math.random()*t.length);return t[o]}(),n[o.countryCode]=o})),r=o.sort((function(t,o){return t.country<o.country?-1:t.country>o.country?1:0})),l=o.slice().sort((function(t,o){let e=t.title.sortable(),i=o.title.sortable();return e<i?-1:e>i?1:0})),a()})),String.prototype.format=function(){let t=this;for(let o=0;o<arguments.length;o++)t=t.replace("{"+o+"}",arguments[o]);return t},String.prototype.sortable=function(){return this.replace(/^(A|The) /,"")}}));