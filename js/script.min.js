"use strict";$(function(){const t="#F0F0F0",o="#555555",i=["#00C4F0","#00BCE5","#00B3DB","#00ABD1","#00A3C7"];let r,n={},e=[],l=[];var s;function a(){(r=new jvm.Map({map:"world_merc",container:$("#map"),backgroundColor:t,zoomMin:.9,focusOn:{x:.5,y:.5,scale:.95},series:{regions:[{attribute:"fill"}]},onRegionClick:(t,e)=>g(e),onRegionTipShow:(t,e,o)=>{o=n[o];o&&e.text(`${o.country}: ${o.title} (${o.year})`)}})).series.regions[0].setValues(function(){var t={};for(var e in r.regions)t[e]=n[e]?n[e].colour:o;return t}())}function c(){r&&(r.remove(),r=void 0)}function u(e,t,o,i){$(e).empty(),t.forEach(t=>{$("<span></span>").addClass("listFilm").prop({title:i(t),style:"background-color: "+t.colour}).text(o(t)).click(()=>g(t.countryCode)).prepend($("<img/>").prop({src:f(t),alt:h(t)})).appendTo(e)})}function p(t){$(t).addClass("selected").siblings().removeClass("selected")}function m(t){$(t).show().siblings().hide()}function g(t){t=n[t];t&&($("#filmCountry").text(t.country),$("#filmTitle").text(t.title),$("#filmYear").text(t.year),$("#filmCountryFlag").prop({src:f(t),alt:h(t)}),$("#filmImageContainer").toggleClass("defaultImage",!t.image),$("#filmImage").prop({src:t.image,alt:`Film poster for ${t.title} (${t.year})`}).toggle(!!t.image),$("#filmOriginalTitle").text(t.originalTitle).toggle(!!t.originalTitle),$("#imdbLink").toggle(!!t.imdb).prop({href:`https://www.imdb.com/title/${t.imdb}/`}),$("#letterboxdLink").toggle(!!t.letterboxd).prop({href:`https://letterboxd.com/film/${t.letterboxd}/`}),$("#rottenTomatoesLink").toggle(!!t.rottenTomatoes).prop({href:"https://www.rottentomatoes.com/m/"+t.rottenTomatoes}),$("#wikipediaLink").toggle(!!t.wikipedia).prop({href:"https://en.wikipedia.org/wiki/"+t.wikipedia}),$("#justwatchLink").toggle(!!t.justwatch).prop({href:"https://www.justwatch.com/uk/movie/"+t.justwatch}),$("#trailerLink").toggle(!!t.trailer).prop({href:"https://youtu.be/"+t.trailer}),$("#reviewLink").toggle(!!t.review).prop({href:"https://youtu.be/"+t.review}),$("#filmReviewer").text(t.reviewer),$("#filmDetailsModal").modal())}function f(t){return`https://flagcdn.com/${t.countryCode.toLowerCase()}.svg`}function h(t){return"National flag of "+t.country}$("a").prop("target","_blank"),$("#btnShowMap").click(()=>{p("#btnShowMap"),m("#sectionMap"),a()}),$("#btnShowListCountries").click(()=>{p("#btnShowListCountries"),m("#sectionListCountries"),c()}),$("#btnShowListFilms").click(()=>{p("#btnShowListFilms"),m("#sectionListFilms"),c()}),$("#btnShowAbout").click(()=>{p("#btnShowAbout"),m("#sectionAbout"),c()}),$("#filmCountryFlag").on({error:function(){$(this).hide()},load:function(){$(this).show()}}),s=()=>{$("#filmCount").text(e.length),a(),u("#listCountries",e,t=>t.country,t=>`${t.title} (${t.year})`),u("#listFilms",l,t=>`${t.title} (${t.year})`,t=>t.country)},e=[],l=[],n={},$.getJSON("data/films.json",t=>{t.forEach(t=>{var e;t.colour=(e=Math.floor(Math.random()*i.length),i[e]),n[t.countryCode]=t}),e=t.sort((t,e)=>t.country<e.country?-1:t.country>e.country?1:0),l=t.slice().sort((t,e)=>{t=t.title.sortable(),e=e.title.sortable();return t<e?-1:e<t?1:0}),s()}),String.prototype.sortable=function(){return this.replace(/^(A|The) /,"")}});