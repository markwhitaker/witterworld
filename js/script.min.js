"use strict";$(function(){const t="#F0F0F0",e="#555555",i=["#00C4F0","#00BCE5","#00B3DB","#00ABD1","#00A3C7"],r="National flag of {0}",o="Film poster for {0}",n="https://flagcdn.com/{0}.svg",l="https://www.imdb.com/title/{0}/",a="https://www.justwatch.com/uk/movie/{0}",s="https://letterboxd.com/film/{0}/",c="https://www.rottentomatoes.com/m/{0}",m="https://en.wikipedia.org/wiki/{0}",u="https://www.youtube.com/watch?v={0}";let f,p={},g=[],w=[];var h;function d(){(f=new jvm.Map({map:"world_merc",container:$("#map"),backgroundColor:t,zoomMin:.9,focusOn:{x:.5,y:.5,scale:.95},series:{regions:[{attribute:"fill"}]},onRegionClick:(t,o)=>v(o),onRegionTipShow:(t,o,e)=>{e=p[e];e&&o.text("{0}: {1} ({2})".format(e.country,e.title,e.year))}})).series.regions[0].setValues(function(){var t={};for(var o in f.regions)t[o]=p[o]?p[o].colour:e;return t}())}function b(){f&&(f.remove(),f=void 0)}function y(o,t,e,i){$(o).empty(),t.forEach(t=>{$("<span></span>").addClass("listFilm").prop({title:i(t),style:"background-color: {0}".format(t.colour)}).text(e(t)).click(()=>v(t.countryCode)).prepend($("<img/>").prop({src:n.format(t.countryCode.toLowerCase()),alt:r.format(t.country)})).appendTo(o)})}function C(t){$(t).addClass("selected").siblings().removeClass("selected")}function k(t){$(t).show().siblings().hide()}function v(t){t=p[t];t&&($("#filmCountry").text(t.country),$("#filmTitle").text(t.title),$("#filmYear").text(t.year),$("#filmCountryFlag").prop({src:n.format(t.countryCode.toLowerCase()),alt:r.format(t.country)}),$("#filmImageContainer").toggleClass("defaultImage",!t.image),$("#filmImage").prop({src:t.image,alt:o.format(t.title)}).toggle(!!t.image),$("#filmOriginalTitle").text(t.originalTitle).toggle(!!t.originalTitle),L("#imdbLink",l,t.imdb),L("#letterboxdLink",s,t.letterboxd),L("#rottenTomatoesLink",c,t.rottenTomatoes),L("#wikipediaLink",m,t.wikipedia),L("#justwatchLink",a,t.justwatch),L("#trailerLink",u,t.trailer),L("#reviewLink",u,t.review),$("#filmReviewer").text(t.reviewer),$("#filmDetailsModal").modal())}function L(t,o,e){$(t).prop({href:o.format(e)}).toggle(!!e)}$("a").prop("target","_blank"),$("#btnShowMap").click(()=>{C("#btnShowMap"),k("#sectionMap"),d()}),$("#btnShowListCountries").click(()=>{C("#btnShowListCountries"),k("#sectionListCountries"),b()}),$("#btnShowListFilms").click(()=>{C("#btnShowListFilms"),k("#sectionListFilms"),b()}),$("#btnShowAbout").click(()=>{C("#btnShowAbout"),k("#sectionAbout"),b()}),$("#filmCountryFlag").on({error:function(){$(this).hide()},load:function(){$(this).show()}}),h=()=>{$("#filmCount").text(g.length),d(),y("#listCountries",g,t=>t.country,t=>"{0} ({1})".format(t.title,t.year)),y("#listFilms",w,t=>"{0} ({1})".format(t.title,t.year),t=>t.country)},g=[],w=[],p={},$.getJSON("data/films.json",t=>{t.forEach(t=>{var o;t.colour=(o=Math.floor(Math.random()*i.length),i[o]),p[t.countryCode]=t}),g=t.sort((t,o)=>t.country<o.country?-1:t.country>o.country?1:0),w=t.slice().sort((t,o)=>{t=t.title.sortable(),o=o.title.sortable();return t<o?-1:o<t?1:0}),h()}),String.prototype.format=function(){let o=this;for(let t=0;t<arguments.length;t++)o=o.replace("{"+t+"}",arguments[t]);return o},String.prototype.sortable=function(){return this.replace(/^(A|The) /,"")}});