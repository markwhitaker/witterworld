"use strict";$(function(){function t(){$("a").prop("target","_blank"),$("#btnShowMap").click(()=>c()),$("#btnShowListCountries").click(()=>a()),$("#btnShowListFilms").click(()=>u()),$("#btnShowAbout").click(()=>f()),$("#filmCountryFlag").on({error:function(){$(this).hide()},load:function(){$(this).show()}})}function o(t){F=[],v=[],x={},$.getJSON("data/films.json",o=>{o.forEach(t=>{t.colour=h(),x[t.countryCode]=t}),F=o.sort((t,o)=>t.country<o.country?-1:t.country>o.country?1:0),v=o.slice().sort((t,o)=>{const e=t.title.sortable(),i=o.title.sortable();return e<i?-1:e>i?1:0}),t()})}function e(){L=new jvm.Map({map:"world_merc",container:$("#map"),backgroundColor:y,zoomMin:.9,focusOn:{x:.5,y:.5,scale:.95},series:{regions:[{attribute:"fill"}]},onRegionClick:(t,o)=>w(o),onRegionTipShow:(t,o,e)=>{const i=x[e];i&&o.text(`${i.country}: ${i.title} (${i.year})`)}}),L.series.regions[0].setValues(g())}function i(){L&&(L.remove(),L=void 0)}function n(){l("#listCountries",F,t=>t.country,t=>`${t.title} (${t.year})`)}function r(){l("#listFilms",v,t=>`${t.title} (${t.year})`,t=>t.country)}function l(t,o,e,i){$(t).empty(),o.forEach(o=>{$("<span></span>").addClass("listFilm").prop({title:i(o),style:`background-color: ${o.colour}`}).text(e(o)).click(()=>w(o.countryCode)).prepend($("<img/>").prop({src:d(o),alt:b(o)})).appendTo(t)})}function s(){$("#filmCount").text(F.length)}function c(){p("#btnShowMap"),m("#sectionMap"),e()}function a(){p("#btnShowListCountries"),m("#sectionListCountries"),i()}function u(){p("#btnShowListFilms"),m("#sectionListFilms"),i()}function f(){p("#btnShowAbout"),m("#sectionAbout"),i()}function p(t){$(t).addClass("selected").siblings().removeClass("selected")}function m(t){$(t).show().siblings().hide()}function g(){const t={};for(const o in L.regions)t[o]=x[o]?x[o].colour:k;return t}function h(){const t=Math.floor(Math.random()*C.length);return C[t]}function w(t){const o=x[t];o&&($("#filmCountry").text(o.country),$("#filmTitle").text(o.title),$("#filmYear").text(o.year),$("#filmCountryFlag").prop({src:d(o),alt:b(o)}),$("#filmImageContainer").toggleClass("defaultImage",!o.image),$("#filmImage").prop({src:o.image,alt:`Film poster for ${o.title} (${o.year})`}).toggle(!!o.image),$("#filmOriginalTitle").text(o.originalTitle).toggle(!!o.originalTitle),$("#imdbLink").toggle(!!o.imdb).prop({href:`https://www.imdb.com/title/${o.imdb}/`}),$("#letterboxdLink").toggle(!!o.letterboxd).prop({href:`https://letterboxd.com/film/${o.letterboxd}/`}),$("#rottenTomatoesLink").toggle(!!o.rottenTomatoes).prop({href:`https://www.rottentomatoes.com/m/${o.rottenTomatoes}`}),$("#wikipediaLink").toggle(!!o.wikipedia).prop({href:`https://en.wikipedia.org/wiki/${o.wikipedia}`}),$("#justwatchLink").toggle(!!o.justwatch).prop({href:`https://www.justwatch.com/uk/movie/${o.justwatch}`}),$("#trailerLink").toggle(!!o.trailer).prop({href:`https://youtu.be/${o.trailer}`}),$("#reviewLink").toggle(!!o.review).prop({href:`https://youtu.be/${o.review}`}),$("#filmReviewer").text(o.reviewer),$("#filmDetailsModal").modal())}function d(t){return`https://flagcdn.com/${t.countryCode.toLowerCase()}.svg`}function b(t){return`National flag of ${t.country}`}const y="#F0F0F0",k="#555555",C=["#00C4F0","#00BCE5","#00B3DB","#00ABD1","#00A3C7"];let L,x={},F=[],v=[];t(),o(()=>{s(),e(),n(),r()}),String.prototype.sortable=function(){return this.replace(/^(A|The) /,"")}});